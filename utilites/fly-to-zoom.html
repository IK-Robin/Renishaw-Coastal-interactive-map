<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simple SVG Map With Zoom & Fly To</title>
<style>
    body { margin:0; background:#111; font-family:Arial; color:white; }
    #controls { padding:10px; background:#222; position:sticky; top:0; z-index:10; }
    button { padding:6px 12px; margin-right:6px; }

    svg { 
        width:100%; 
        height:100vh;
        background:#0d141c; 
        cursor:grab; 
        user-select:none;
    }
    svg:active { cursor:grabbing; }

    .region { fill:#3b82f6; stroke:white; stroke-width:2; cursor:pointer; }
    .region:hover { fill:#60a5fa; }
</style>
</head>
<body>

<div id="controls">
    <button id="zoomInBtn">Zoom In +</button>
    <button id="zoomOutBtn">Zoom Out -</button>
    <button id="resetBtn">Reset</button>
</div>

<svg id="map" viewBox="0 0 800 600">
    <g id="stage">

        <!-- Simple clickable areas -->
        <rect id="r1" class="region" x="100" y="100" width="200" height="150"></rect>
        <rect id="r2" class="region" x="400" y="80" width="250" height="120"></rect>
        <rect id="r3" class="region" x="350" y="300" width="180" height="200"></rect>

    </g>
</svg>

<script>
/* --------------------------------------------------
   BASIC PAN + ZOOM + FLY-TO SETUP
-------------------------------------------------- */
const map = document.getElementById("map");
const stage = document.getElementById("stage");

let t = { x:0, y:0, scale:1 };
let isPanning = false;
let start = { x:0, y:0 };

function apply() {
    stage.setAttribute("transform", `translate(${t.x},${t.y}) scale(${t.scale})`);
}

/* --------------------------------------------------
   ZOOM BUTTONS
-------------------------------------------------- */
document.getElementById("zoomInBtn").onclick = () => {
    t.scale *= 1.25;
    apply();
};
document.getElementById("zoomOutBtn").onclick = () => {
    t.scale /= 1.25;
    apply();
};
document.getElementById("resetBtn").onclick = () => {
    t = { x:0, y:0, scale:1 };
    apply();
};

/* --------------------------------------------------
   PAN (DRAG THE MAP)
-------------------------------------------------- */
map.addEventListener("mousedown", (e) => {
    isPanning = true;
    start = { x: e.clientX - t.x, y: e.clientY - t.y };
});

map.addEventListener("mousemove", (e) => {
    if (!isPanning) return;
    t.x = e.clientX - start.x;
    t.y = e.clientY - start.y;
    apply();
});

map.addEventListener("mouseup", () => isPanning = false);
map.addEventListener("mouseleave", () => isPanning = false);

/* --------------------------------------------------
   FLY TO — Smooth zoom to a clicked region
-------------------------------------------------- */
function flyTo(element, targetScale = 2.5, duration = 500) {
    const bb = element.getBBox();
    const cx = bb.x + bb.width / 2;
    const cy = bb.y + bb.height / 2;

    // Target transform values
    const startX = t.x, startY = t.y, startScale = t.scale;

    const endScale = targetScale;
    const endX = window.innerWidth/2 - cx * endScale;
    const endY = window.innerHeight/2 - cy * endScale;

    const startTime = performance.now();

    function animate(now) {
        const progress = Math.min((now - startTime) / duration, 1);
        const ease = 1 - Math.pow(1 - progress, 3);

        t.scale = startScale + (endScale - startScale) * ease;
        t.x = startX + (endX - startX) * ease;
        t.y = startY + (endY - startY) * ease;

        apply();

        if (progress < 1) requestAnimationFrame(animate);
    }

    requestAnimationFrame(animate);
}

/* --------------------------------------------------
   CLICK REGIONS → FLY TO THEM
-------------------------------------------------- */
document.querySelectorAll(".region").forEach(r => {
    r.addEventListener("click", (e) => {
        e.stopPropagation(); // prevent panning click
        flyTo(r, 3); // zoom level 3
    });
});
</script>

</body>
</html>
